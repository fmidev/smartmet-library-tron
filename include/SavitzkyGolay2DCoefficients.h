// ======================================================================
/*!
 * \brief 2D Savitzky-Golay smoothing filter coefficients
 *
 * Source:
 *
 * http://research.microsoft.com/en-us/um/people/jckrumm/savgol/savgol.htm
 *
 * Since the original matrix coefficients are rational, so are those
 * in the pseudoinverse. Hence a little program was made to convert
 * the original floating point coefficients into rational form.
 */
// ======================================================================

#pragma once

namespace Tron
{
namespace SavitzkyGolay2DCoefficients
{
// Smoothing coefficients of given size and order

int coeff_3_1 = 9;
int coeffs_3_1[3 * 3] = {1, 1, 1, 1, 1, 1, 1, 1, 1};

int coeff_3_2 = 9;
int coeffs_3_2[3 * 3] = {-1, 2, -1, 2, 5, 2, -1, 2, -1};

int coeff_5_1 = 25;
int coeffs_5_1[5 * 5] = {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1};

int coeff_5_2 = 175;
int coeffs_5_2[5 * 5] = {-13, 2, 7, 2,  -13, 2,  17, 22,  17, 2, 7, 22, 27,
                         22,  7, 2, 17, 22,  17, 2,  -13, 2,  7, 2, -13};

int coeff_5_3 = 175;
int coeffs_5_3[5 * 5] = {-13, 2, 7, 2,  -13, 2,  17, 22,  17, 2, 7, 22, 27,
                         22,  7, 2, 17, 22,  17, 2,  -13, 2,  7, 2, -13};

int coeff_5_4 = 1225;
int coeffs_5_4[5 * 5] = {51,  -99, 96,  -99, 51,  -99, -24, 246, -24, -99, 96,  246, 541,
                         246, 96,  -99, -24, 246, -24, -99, 51,  -99, 96,  -99, 51};

int coeff_5_5 = 1225;
int coeffs_5_5[5 * 5] = {51,  -99, 96,  -99, 51,  -99, -24, 246, -24, -99, 96,  246, 541,
                         246, 96,  -99, -24, 246, -24, -99, 51,  -99, 96,  -99, 51};

int coeff_7_1 = 49;
int coeffs_7_1[7 * 7] = {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1};

int coeff_7_2 = 147;
int coeffs_7_2[7 * 7] = {-7, -2, 1, 2, 1, -2, -7, -2, 3,  6,  7, 6, 3, -2, 1,  6, 9,
                         10, 9,  6, 1, 2, 7,  10, 11, 10, 7,  2, 1, 6, 9,  10, 9, 6,
                         1,  -2, 3, 6, 7, 6,  3,  -2, -7, -2, 1, 2, 1, -2, -7};

int coeff_7_3 = 147;
int coeffs_7_3[7 * 7] = {-7, -2, 1, 2, 1, -2, -7, -2, 3,  6,  7, 6, 3, -2, 1,  6, 9,
                         10, 9,  6, 1, 2, 7,  10, 11, 10, 7,  2, 1, 6, 9,  10, 9, 6,
                         1,  -2, 3, 6, 7, 6,  3,  -2, -7, -2, 1, 2, 1, -2, -7};

int coeff_7_4 = 4851;
int coeffs_7_4[7 * 7] = {206,  -174, -24,  89,  -24,  -174, 206, -174, -279, 36,   204,  36,  -279,
                         -174, -24,  36,   450, 651,  450,  36,  -24,  89,   204,  651,  863, 651,
                         204,  89,   -24,  36,  450,  651,  450, 36,   -24,  -174, -279, 36,  204,
                         36,   -279, -174, 206, -174, -24,  89,  -24,  -174, 206};

int coeff_7_5 = 4851;
int coeffs_7_5[7 * 7] = {206,  -174, -24,  89,  -24,  -174, 206, -174, -279, 36,   204,  36,  -279,
                         -174, -24,  36,   450, 651,  450,  36,  -24,  89,   204,  651,  863, 651,
                         204,  89,   -24,  36,  450,  651,  450, 36,   -24,  -174, -279, 36,  204,
                         36,   -279, -174, 206, -174, -24,  89,  -24,  -174, 206};

int coeff_9_1 = 81;
int coeffs_9_1[9 * 9] = {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1};

int coeff_9_2 = 6237;
int coeffs_9_2[9 * 9] = {-203, -98, -23,  22,  37,  22,  -23, -98, -203, -98, 7,   82,  127, 142,
                         127,  82,  7,    -98, -23, 82,  157, 202, 217,  202, 157, 82,  -23, 22,
                         127,  202, 247,  262, 247, 202, 127, 22,  37,   142, 217, 262, 277, 262,
                         217,  142, 37,   22,  127, 202, 247, 262, 247,  202, 127, 22,  -23, 82,
                         157,  202, 217,  202, 157, 82,  -23, -98, 7,    82,  127, 142, 127, 82,
                         7,    -98, -203, -98, -23, 22,  37,  22,  -23,  -98, -203};

int coeff_9_3 = 6237;
int coeffs_9_3[9 * 9] = {-203, -98, -23,  22,  37,  22,  -23, -98, -203, -98, 7,   82,  127, 142,
                         127,  82,  7,    -98, -23, 82,  157, 202, 217,  202, 157, 82,  -23, 22,
                         127,  202, 247,  262, 247, 202, 127, 22,  37,   142, 217, 262, 277, 262,
                         217,  142, 37,   22,  127, 202, 247, 262, 247,  202, 127, 22,  -23, 82,
                         157,  202, 217,  202, 157, 82,  -23, -98, 7,    82,  127, 142, 127, 82,
                         7,    -98, -203, -98, -23, 22,  37,  22,  -23,  -98, -203};

int coeff_9_4 = 33033;
int coeffs_9_4[9 * 9] = {1197, -413, -408, 57,   289,   57,   -408, -413, 1197, -413, -1265, -718,
                         72,   412,  72,   -718, -1265, -413, -408, -718, 216,  1238, 1655,  1238,
                         216,  -718, -408, 57,   72,    1238, 2399, 2863, 2399, 1238, 72,    57,
                         289,  412,  1655, 2863, 3343,  2863, 1655, 412,  289,  57,   72,    1238,
                         2399, 2863, 2399, 1238, 72,    57,   -408, -718, 216,  1238, 1655,  1238,
                         216,  -718, -408, -413, -1265, -718, 72,   412,  72,   -718, -1265, -413,
                         1197, -413, -408, 57,   289,   57,   -408, -413, 1197};

int coeff_9_5 = 33033;
int coeffs_9_5[9 * 9] = {1197, -413, -408, 57,   289,   57,   -408, -413, 1197, -413, -1265, -718,
                         72,   412,  72,   -718, -1265, -413, -408, -718, 216,  1238, 1655,  1238,
                         216,  -718, -408, 57,   72,    1238, 2399, 2863, 2399, 1238, 72,    57,
                         289,  412,  1655, 2863, 3343,  2863, 1655, 412,  289,  57,   72,    1238,
                         2399, 2863, 2399, 1238, 72,    57,   -408, -718, 216,  1238, 1655,  1238,
                         216,  -718, -408, -413, -1265, -718, 72,   412,  72,   -718, -1265, -413,
                         1197, -413, -408, 57,   289,   57,   -408, -413, 1197};

int coeff_11_1 = 121;
int coeffs_11_1[11 * 11] = {
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1};

int coeff_11_2 = 4719;
int coeffs_11_2[11 * 11] = {
    -111, -66, -31,  -6,  9,   14,  9,   -6,  -31, -66, -111, -66, -21, 14,  39,  54,  59,  54,
    39,   14,  -21,  -66, -31, 14,  49,  74,  89,  94,  89,   74,  49,  14,  -31, -6,  39,  74,
    99,   114, 119,  114, 99,  74,  39,  -6,  9,   54,  89,   114, 129, 134, 129, 114, 89,  54,
    9,    14,  59,   94,  119, 134, 139, 134, 119, 94,  59,   14,  9,   54,  89,  114, 129, 134,
    129,  114, 89,   54,  9,   -6,  39,  74,  99,  114, 119,  114, 99,  74,  39,  -6,  -31, 14,
    49,   74,  89,   94,  89,  74,  49,  14,  -31, -66, -21,  14,  39,  54,  59,  54,  39,  14,
    -21,  -66, -111, -66, -31, -6,  9,   14,  9,   -6,  -31,  -66, -111};

int coeff_11_3 = 4719;
int coeffs_11_3[11 * 11] = {
    -111, -66, -31,  -6,  9,   14,  9,   -6,  -31, -66, -111, -66, -21, 14,  39,  54,  59,  54,
    39,   14,  -21,  -66, -31, 14,  49,  74,  89,  94,  89,   74,  49,  14,  -31, -6,  39,  74,
    99,   114, 119,  114, 99,  74,  39,  -6,  9,   54,  89,   114, 129, 134, 129, 114, 89,  54,
    9,    14,  59,   94,  119, 134, 139, 134, 119, 94,  59,   14,  9,   54,  89,  114, 129, 134,
    129,  114, 89,   54,  9,   -6,  39,  74,  99,  114, 119,  114, 99,  74,  39,  -6,  -31, 14,
    49,   74,  89,   94,  89,  74,  49,  14,  -31, -66, -21,  14,  39,  54,  59,  54,  39,  14,
    -21,  -66, -111, -66, -31, -6,  9,   14,  9,   -6,  -31,  -66, -111};

int coeff_11_4 = 20449;
int coeffs_11_4[11 * 11] = {
    612,  -36,  -176, -81,  54,   112,  54,   -81,  -176, -36,  612,  -36,  -459, -424, -204, 6,
    89,   6,    -204, -424, -459, -36,  -176, -424, -253, 64,   333,  435,  333,  64,   -253, -424,
    -176, -81,  -204, 64,   451,  761,  877,  761,  451,  64,   -204, -81,  54,   6,    333,  761,
    1096, 1221, 1096, 761,  333,  6,    54,   112,  89,   435,  877,  1221, 1348, 1221, 877,  435,
    89,   112,  54,   6,    333,  761,  1096, 1221, 1096, 761,  333,  6,    54,   -81,  -204, 64,
    451,  761,  877,  761,  451,  64,   -204, -81,  -176, -424, -253, 64,   333,  435,  333,  64,
    -253, -424, -176, -36,  -459, -424, -204, 6,    89,   6,    -204, -424, -459, -36,  612,  -36,
    -176, -81,  54,   112,  54,   -81,  -176, -36,  612};

int coeff_11_5 = 20449;
int coeffs_11_5[11 * 11] = {
    612,  -36,  -176, -81,  54,   112,  54,   -81,  -176, -36,  612,  -36,  -459, -424, -204, 6,
    89,   6,    -204, -424, -459, -36,  -176, -424, -253, 64,   333,  435,  333,  64,   -253, -424,
    -176, -81,  -204, 64,   451,  761,  877,  761,  451,  64,   -204, -81,  54,   6,    333,  761,
    1096, 1221, 1096, 761,  333,  6,    54,   112,  89,   435,  877,  1221, 1348, 1221, 877,  435,
    89,   112,  54,   6,    333,  761,  1096, 1221, 1096, 761,  333,  6,    54,   -81,  -204, 64,
    451,  761,  877,  761,  451,  64,   -204, -81,  -176, -424, -253, 64,   333,  435,  333,  64,
    -253, -424, -176, -36,  -459, -424, -204, 6,    89,   6,    -204, -424, -459, -36,  612,  -36,
    -176, -81,  54,   112,  54,   -81,  -176, -36,  612};

int coeff_13_1 = 169;
int coeffs_13_1[13 * 13] = {
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1};

int coeff_13_2 = 1859;
int coeffs_13_2[13 * 13] = {
    -33, -22, -13, -6,  -1,  2,   3,   2,   -1, -6,  -13, -22, -33, -22, -11, -2,  5,   10, 13,
    14,  13,  10,  5,   -2,  -11, -22, -13, -2, 7,   14,  19,  22,  23,  22,  19,  14,  7,  -2,
    -13, -6,  5,   14,  21,  26,  29,  30,  29, 26,  21,  14,  5,   -6,  -1,  10,  19,  26, 31,
    34,  35,  34,  31,  26,  19,  10,  -1,  2,  13,  22,  29,  34,  37,  38,  37,  34,  29, 22,
    13,  2,   3,   14,  23,  30,  35,  38,  39, 38,  35,  30,  23,  14,  3,   2,   13,  22, 29,
    34,  37,  38,  37,  34,  29,  22,  13,  2,  -1,  10,  19,  26,  31,  34,  35,  34,  31, 26,
    19,  10,  -1,  -6,  5,   14,  21,  26,  29, 30,  29,  26,  21,  14,  5,   -6,  -13, -2, 7,
    14,  19,  22,  23,  22,  19,  14,  7,   -2, -13, -22, -11, -2,  5,   10,  13,  14,  13, 10,
    5,   -2,  -11, -22, -33, -22, -13, -6,  -1, 2,   3,   2,   -1,  -6,  -13, -22, -33};

int coeff_13_3 = 1859;
int coeffs_13_3[13 * 13] = {
    -33, -22, -13, -6,  -1,  2,   3,   2,   -1, -6,  -13, -22, -33, -22, -11, -2,  5,   10, 13,
    14,  13,  10,  5,   -2,  -11, -22, -13, -2, 7,   14,  19,  22,  23,  22,  19,  14,  7,  -2,
    -13, -6,  5,   14,  21,  26,  29,  30,  29, 26,  21,  14,  5,   -6,  -1,  10,  19,  26, 31,
    34,  35,  34,  31,  26,  19,  10,  -1,  2,  13,  22,  29,  34,  37,  38,  37,  34,  29, 22,
    13,  2,   3,   14,  23,  30,  35,  38,  39, 38,  35,  30,  23,  14,  3,   2,   13,  22, 29,
    34,  37,  38,  37,  34,  29,  22,  13,  2,  -1,  10,  19,  26,  31,  34,  35,  34,  31, 26,
    19,  10,  -1,  -6,  5,   14,  21,  26,  29, 30,  29,  26,  21,  14,  5,   -6,  -13, -2, 7,
    14,  19,  22,  23,  22,  19,  14,  7,   -2, -13, -22, -11, -2,  5,   10,  13,  14,  13, 10,
    5,   -2,  -11, -22, -33, -22, -13, -6,  -1, 2,   3,   2,   -1,  -6,  -13, -22, -33};

int coeff_13_4 = 31603;
int coeffs_13_4[13 * 13] = {
    781,  99,   -144, -137, -27,  81,   124,  81,   -27,  -137, -144, 99,   781,  99,   -396, -486,
    -360, -165, -6,   54,   -6,   -165, -360, -486, -396, 99,   -144, -486, -451, -227, 37,   238,
    312,  238,  37,   -227, -451, -486, -144, -137, -360, -227, 72,   390,  623,  708,  623,  390,
    72,   -227, -360, -137, -27,  -165, 37,   390,  748,  1004, 1096, 1004, 748,  390,  37,   -165,
    -27,  81,   -6,   238,  623,  1004, 1274, 1371, 1274, 1004, 623,  238,  -6,   81,   124,  54,
    312,  708,  1096, 1371, 1470, 1371, 1096, 708,  312,  54,   124,  81,   -6,   238,  623,  1004,
    1274, 1371, 1274, 1004, 623,  238,  -6,   81,   -27,  -165, 37,   390,  748,  1004, 1096, 1004,
    748,  390,  37,   -165, -27,  -137, -360, -227, 72,   390,  623,  708,  623,  390,  72,   -227,
    -360, -137, -144, -486, -451, -227, 37,   238,  312,  238,  37,   -227, -451, -486, -144, 99,
    -396, -486, -360, -165, -6,   54,   -6,   -165, -360, -486, -396, 99,   781,  99,   -144, -137,
    -27,  81,   124,  81,   -27,  -137, -144, 99,   781};

int coeff_13_5 = 31603;
int coeffs_13_5[13 * 13] = {
    781,  99,   -144, -137, -27,  81,   124,  81,   -27,  -137, -144, 99,   781,  99,   -396, -486,
    -360, -165, -6,   54,   -6,   -165, -360, -486, -396, 99,   -144, -486, -451, -227, 37,   238,
    312,  238,  37,   -227, -451, -486, -144, -137, -360, -227, 72,   390,  623,  708,  623,  390,
    72,   -227, -360, -137, -27,  -165, 37,   390,  748,  1004, 1096, 1004, 748,  390,  37,   -165,
    -27,  81,   -6,   238,  623,  1004, 1274, 1371, 1274, 1004, 623,  238,  -6,   81,   124,  54,
    312,  708,  1096, 1371, 1470, 1371, 1096, 708,  312,  54,   124,  81,   -6,   238,  623,  1004,
    1274, 1371, 1274, 1004, 623,  238,  -6,   81,   -27,  -165, 37,   390,  748,  1004, 1096, 1004,
    748,  390,  37,   -165, -27,  -137, -360, -227, 72,   390,  623,  708,  623,  390,  72,   -227,
    -360, -137, -144, -486, -451, -227, 37,   238,  312,  238,  37,   -227, -451, -486, -144, 99,
    -396, -486, -360, -165, -6,   54,   -6,   -165, -360, -486, -396, 99,   781,  99,   -144, -137,
    -27,  81,   124,  81,   -27,  -137, -144, 99,   781};

int denoms[6][5] = {{coeff_3_1, coeff_3_2, 0, 0, 0},
                    {coeff_5_1, coeff_5_2, coeff_5_3, coeff_5_4, coeff_5_5},
                    {coeff_7_1, coeff_7_2, coeff_7_3, coeff_7_4, coeff_7_5},
                    {coeff_9_1, coeff_9_2, coeff_9_3, coeff_9_4, coeff_9_5},
                    {coeff_11_1, coeff_11_2, coeff_11_3, coeff_11_4, coeff_11_5},
                    {coeff_13_1, coeff_13_2, coeff_13_3, coeff_13_4, coeff_13_5}};

int* coeffs[6][5] = {{coeffs_3_1, coeffs_3_2, 0, 0, 0},
                     {coeffs_5_1, coeffs_5_2, coeffs_5_3, coeffs_5_4, coeffs_5_5},
                     {coeffs_7_1, coeffs_7_2, coeffs_7_3, coeffs_7_4, coeffs_7_5},
                     {coeffs_9_1, coeffs_9_2, coeffs_9_3, coeffs_9_4, coeffs_9_5},
                     {coeffs_11_1, coeffs_11_2, coeffs_11_3, coeffs_11_4, coeffs_11_5},
                     {coeffs_13_1, coeffs_13_2, coeffs_13_3, coeffs_13_4, coeffs_13_5}};
}
}  // namespace Tron::SavitzkyGolay2DCoefficients
